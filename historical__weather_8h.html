<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Oyster Harvest Area Closure Analysis: include/BOM/historical_weather.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Oyster Harvest Area Closure Analysis<span id="projectnumber">&#160;0.1</span>
   </div>
   <div id="projectbrief">Prediction and analysis of NSW oyster harvest area closures.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('historical__weather_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">historical_weather.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;time.h&gt;</code><br />
<code>#include &lt;curl/curl.h&gt;</code><br />
<code>#include &lt;ctype.h&gt;</code><br />
<code>#include &lt;libpq-fe.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &quot;<a class="el" href="transform_8h_source.html">transform.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="stations_8h_source.html">BOM/stations.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ftp_8h_source.html">ftp.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for historical_weather.h:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="historical__weather_8h__incl.svg" width="1830" height="579"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="historical__weather_8h__dep__incl.svg" width="294" height="212"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div>
<p><a href="historical__weather_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_b_o_m___weather_dataset___type_def.html">BOM_WeatherDataset_TypeDef</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a5792b5fcf04b63a878814e8e46c16630"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="historical__weather_8h.html#a5792b5fcf04b63a878814e8e46c16630">BOM_RESPONSE_BUFFER_SIZE</a>&#160;&#160;&#160;200</td></tr>
<tr class="memdesc:a5792b5fcf04b63a878814e8e46c16630"><td class="mdescLeft">&#160;</td><td class="mdescRight">Max number of items in weather dataset.  <a href="historical__weather_8h.html#a5792b5fcf04b63a878814e8e46c16630">More...</a><br /></td></tr>
<tr class="separator:a5792b5fcf04b63a878814e8e46c16630"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fe18882d97d5672bb0a2d80d1e28682"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="historical__weather_8h.html#a5fe18882d97d5672bb0a2d80d1e28682">BOM_TIME_STR_BUFFER_SIZE</a>&#160;&#160;&#160;30</td></tr>
<tr class="memdesc:a5fe18882d97d5672bb0a2d80d1e28682"><td class="mdescLeft">&#160;</td><td class="mdescRight">Max number of chars in timestamp buffer.  <a href="historical__weather_8h.html#a5fe18882d97d5672bb0a2d80d1e28682">More...</a><br /></td></tr>
<tr class="separator:a5fe18882d97d5672bb0a2d80d1e28682"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0cfeba67c248faf642a8c73a20626b8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="historical__weather_8h.html#af0cfeba67c248faf642a8c73a20626b8">BOM_MAX_RESPONSE_SIZE</a>&#160;&#160;&#160;10000</td></tr>
<tr class="memdesc:af0cfeba67c248faf642a8c73a20626b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Max buffer size to read into memory (size of .csv file from BOM FTP server)  <a href="historical__weather_8h.html#af0cfeba67c248faf642a8c73a20626b8">More...</a><br /></td></tr>
<tr class="separator:af0cfeba67c248faf642a8c73a20626b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a848c6121721e4283f03a048ca7912fde"><td class="memItemLeft" align="right" valign="top">CURLcode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="historical__weather_8h.html#a848c6121721e4283f03a048ca7912fde">BOM_GetWeather</a> (<a class="el" href="struct_b_o_m___weather_dataset___type_def.html">BOM_WeatherDataset_TypeDef</a> *dataset, <a class="el" href="struct_b_o_m___weather_station___type_def.html">BOM_WeatherStation_TypeDef</a> *station, const char *year_month)</td></tr>
<tr class="memdesc:a848c6121721e4283f03a048ca7912fde"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get historical weather for a particular BOM weather station.  <a href="historical__weather_8h.html#a848c6121721e4283f03a048ca7912fde">More...</a><br /></td></tr>
<tr class="separator:a848c6121721e4283f03a048ca7912fde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab596a78a9e22aee099c2b1d399e7587b"><td class="memItemLeft" align="right" valign="top">int8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="historical__weather_8h.html#ab596a78a9e22aee099c2b1d399e7587b">BOM_LoadWeatherFromCSV</a> (const char *filename, <a class="el" href="struct_b_o_m___weather_dataset___type_def.html">BOM_WeatherDataset_TypeDef</a> *dataset, <a class="el" href="struct_b_o_m___weather_station___type_def.html">BOM_WeatherStation_TypeDef</a> *station)</td></tr>
<tr class="memdesc:ab596a78a9e22aee099c2b1d399e7587b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load BOM weather station dataset from .csv file.  <a href="historical__weather_8h.html#ab596a78a9e22aee099c2b1d399e7587b">More...</a><br /></td></tr>
<tr class="separator:ab596a78a9e22aee099c2b1d399e7587b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66ed16101a6e5215921e1c235df386ca"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="historical__weather_8h.html#a66ed16101a6e5215921e1c235df386ca">BOM_HistoricalWeatherToDB</a> (<a class="el" href="struct_b_o_m___weather_station___type_def.html">BOM_WeatherStation_TypeDef</a> *weather_station, <a class="el" href="struct_b_o_m___weather_dataset___type_def.html">BOM_WeatherDataset_TypeDef</a> *dataset, PGconn *psql_conn)</td></tr>
<tr class="memdesc:a66ed16101a6e5215921e1c235df386ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write observed weather to PostgreSQL table (weather_bom)  <a href="historical__weather_8h.html#a66ed16101a6e5215921e1c235df386ca">More...</a><br /></td></tr>
<tr class="separator:a66ed16101a6e5215921e1c235df386ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1256c64c52d784a59bd429740cb37c82"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="historical__weather_8h.html#a1256c64c52d784a59bd429740cb37c82">BOM_TimeseriesToDB</a> (const char *start_time, PGconn *psql_conn)</td></tr>
<tr class="separator:a1256c64c52d784a59bd429740cb37c82"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="af0cfeba67c248faf642a8c73a20626b8" name="af0cfeba67c248faf642a8c73a20626b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0cfeba67c248faf642a8c73a20626b8">&#9670;&#160;</a></span>BOM_MAX_RESPONSE_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BOM_MAX_RESPONSE_SIZE&#160;&#160;&#160;10000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Max buffer size to read into memory (size of .csv file from BOM FTP server) </p>

</div>
</div>
<a id="a5792b5fcf04b63a878814e8e46c16630" name="a5792b5fcf04b63a878814e8e46c16630"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5792b5fcf04b63a878814e8e46c16630">&#9670;&#160;</a></span>BOM_RESPONSE_BUFFER_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BOM_RESPONSE_BUFFER_SIZE&#160;&#160;&#160;200</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Max number of items in weather dataset. </p>

</div>
</div>
<a id="a5fe18882d97d5672bb0a2d80d1e28682" name="a5fe18882d97d5672bb0a2d80d1e28682"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fe18882d97d5672bb0a2d80d1e28682">&#9670;&#160;</a></span>BOM_TIME_STR_BUFFER_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BOM_TIME_STR_BUFFER_SIZE&#160;&#160;&#160;30</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Max number of chars in timestamp buffer. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a848c6121721e4283f03a048ca7912fde" name="a848c6121721e4283f03a048ca7912fde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a848c6121721e4283f03a048ca7912fde">&#9670;&#160;</a></span>BOM_GetWeather()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CURLcode BOM_GetWeather </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_b_o_m___weather_dataset___type_def.html">BOM_WeatherDataset_TypeDef</a> *&#160;</td>
          <td class="paramname"><em>dataset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_b_o_m___weather_station___type_def.html">BOM_WeatherStation_TypeDef</a> *&#160;</td>
          <td class="paramname"><em>station</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>year_month</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get historical weather for a particular BOM weather station. </p>
<p >Get a file from the Bureau of Meterology FTP server.</p>
<p >The BOM provides formatted .csv files for certain locations in Australia. These .csv files can be downloaded from the BOM's FTP server. Currently, it is unknown when the data is updated (sometime daily).</p>
<dl class="section see"><dt>See also</dt><dd><a href="http://www.bom.gov.au/catalogue/anon-ftp.shtml">http://www.bom.gov.au/catalogue/anon-ftp.shtml</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dataset</td><td>Timeseries dataset to populate with data. </td></tr>
    <tr><td class="paramname">filename</td><td>Station filename obtained from BOM_Stations_TypeDef. </td></tr>
    <tr><td class="paramname">year_month</td><td>Year and month of interest e.g. 202206 for 2022 06 (June) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns cURL status code. </dd></dl>

</div>
</div>
<a id="a66ed16101a6e5215921e1c235df386ca" name="a66ed16101a6e5215921e1c235df386ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66ed16101a6e5215921e1c235df386ca">&#9670;&#160;</a></span>BOM_HistoricalWeatherToDB()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BOM_HistoricalWeatherToDB </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_b_o_m___weather_station___type_def.html">BOM_WeatherStation_TypeDef</a> *&#160;</td>
          <td class="paramname"><em>weather_station</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_b_o_m___weather_dataset___type_def.html">BOM_WeatherDataset_TypeDef</a> *&#160;</td>
          <td class="paramname"><em>dataset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PGconn *&#160;</td>
          <td class="paramname"><em>psql_conn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write observed weather to PostgreSQL table (weather_bom) </p>
<p >Turn a weather station dataset from the BOM into database values.</p>
<p >Rows that already exist are overwritten, new rows are added. Need to ensure each dataset and weather station are from the same source. These data are inserted into the weather_bom PostgreSQL table.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">weather_station</td><td>BOM weather station information. </td></tr>
    <tr><td class="paramname">dataset</td><td>BOM weather station dataset. </td></tr>
    <tr><td class="paramname">psql_conn</td><td>PostgreSQL connection handler. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab596a78a9e22aee099c2b1d399e7587b" name="ab596a78a9e22aee099c2b1d399e7587b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab596a78a9e22aee099c2b1d399e7587b">&#9670;&#160;</a></span>BOM_LoadWeatherFromCSV()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int8_t BOM_LoadWeatherFromCSV </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_b_o_m___weather_dataset___type_def.html">BOM_WeatherDataset_TypeDef</a> *&#160;</td>
          <td class="paramname"><em>dataset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_b_o_m___weather_station___type_def.html">BOM_WeatherStation_TypeDef</a> *&#160;</td>
          <td class="paramname"><em>station</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load BOM weather station dataset from .csv file. </p>
<p >Load a BOM dataset from a cached .csv file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>File to load (includes path). </td></tr>
    <tr><td class="paramname">dataset</td><td>Dataset to populate. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Status code. </dd></dl>

</div>
</div>
<a id="a1256c64c52d784a59bd429740cb37c82" name="a1256c64c52d784a59bd429740cb37c82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1256c64c52d784a59bd429740cb37c82">&#9670;&#160;</a></span>BOM_TimeseriesToDB()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BOM_TimeseriesToDB </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>start_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PGconn *&#160;</td>
          <td class="paramname"><em>psql_conn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_fe989704db714b4572d9eabbbeeb86b1.html">BOM</a></li><li class="navelem"><a class="el" href="historical__weather_8h.html">historical_weather.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
