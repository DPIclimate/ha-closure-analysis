<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Oyster HA Closure Analysis: src/BOM/historical_weather.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Oyster HA Closure Analysis<span id="projectnumber">&#160;0.1</span>
   </div>
   <div id="projectbrief">Prediction and analysis of oyster harvest area closures.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('historical__weather_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">historical_weather.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="historical__weather_8h_source.html">BOM/historical_weather.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for historical_weather.c:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="historical__weather_8c__incl.svg" width="986" height="500"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aae0ff9343e29da7ec59110cb0801c75b"><td class="memItemLeft" align="right" valign="top">static int8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="historical__weather_8c.html#aae0ff9343e29da7ec59110cb0801c75b">BOM_ParseWeather</a> (<a class="el" href="struct_utils___req_data___type_def.html">Utils_ReqData_TypeDef</a> *stream, <a class="el" href="struct_b_o_m___weather_dataset___type_def.html">BOM_WeatherDataset_TypeDef</a> *dataset, <a class="el" href="struct_b_o_m___weather_station___type_def.html">BOM_WeatherStation_TypeDef</a> *station)</td></tr>
<tr class="separator:aae0ff9343e29da7ec59110cb0801c75b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a848c6121721e4283f03a048ca7912fde"><td class="memItemLeft" align="right" valign="top">CURLcode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="historical__weather_8c.html#a848c6121721e4283f03a048ca7912fde">BOM_GetWeather</a> (<a class="el" href="struct_b_o_m___weather_dataset___type_def.html">BOM_WeatherDataset_TypeDef</a> *dataset, <a class="el" href="struct_b_o_m___weather_station___type_def.html">BOM_WeatherStation_TypeDef</a> *station, const char *year_month)</td></tr>
<tr class="memdesc:a848c6121721e4283f03a048ca7912fde"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get historical weather for a particular BOM weather station.  <a href="historical__weather_8c.html#a848c6121721e4283f03a048ca7912fde">More...</a><br /></td></tr>
<tr class="separator:a848c6121721e4283f03a048ca7912fde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab596a78a9e22aee099c2b1d399e7587b"><td class="memItemLeft" align="right" valign="top">int8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="historical__weather_8c.html#ab596a78a9e22aee099c2b1d399e7587b">BOM_LoadWeatherFromCSV</a> (const char *filename, <a class="el" href="struct_b_o_m___weather_dataset___type_def.html">BOM_WeatherDataset_TypeDef</a> *dataset, <a class="el" href="struct_b_o_m___weather_station___type_def.html">BOM_WeatherStation_TypeDef</a> *station)</td></tr>
<tr class="memdesc:ab596a78a9e22aee099c2b1d399e7587b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load BOM weather station dataset from .csv file.  <a href="historical__weather_8c.html#ab596a78a9e22aee099c2b1d399e7587b">More...</a><br /></td></tr>
<tr class="separator:ab596a78a9e22aee099c2b1d399e7587b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66ed16101a6e5215921e1c235df386ca"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="historical__weather_8c.html#a66ed16101a6e5215921e1c235df386ca">BOM_HistoricalWeatherToDB</a> (<a class="el" href="struct_b_o_m___weather_station___type_def.html">BOM_WeatherStation_TypeDef</a> *weather_station, <a class="el" href="struct_b_o_m___weather_dataset___type_def.html">BOM_WeatherDataset_TypeDef</a> *dataset, PGconn *psql_conn)</td></tr>
<tr class="memdesc:a66ed16101a6e5215921e1c235df386ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write observed weather to PostgreSQL table (weather_bom)  <a href="historical__weather_8c.html#a66ed16101a6e5215921e1c235df386ca">More...</a><br /></td></tr>
<tr class="separator:a66ed16101a6e5215921e1c235df386ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a848c6121721e4283f03a048ca7912fde" name="a848c6121721e4283f03a048ca7912fde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a848c6121721e4283f03a048ca7912fde">&#9670;&nbsp;</a></span>BOM_GetWeather()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CURLcode BOM_GetWeather </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_b_o_m___weather_dataset___type_def.html">BOM_WeatherDataset_TypeDef</a> *&#160;</td>
          <td class="paramname"><em>dataset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_b_o_m___weather_station___type_def.html">BOM_WeatherStation_TypeDef</a> *&#160;</td>
          <td class="paramname"><em>station</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>year_month</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get historical weather for a particular BOM weather station. </p>
<p >Get a file from the Bureau of Meterology FTP server.</p>
<p >The BOM provides formatted .csv files for certain locations in Australia. These .csv files can be downloaded from the BOM's FTP server. Currently, it is unknown when the data is updated (sometime daily).</p>
<dl class="section see"><dt>See also</dt><dd><a href="http://www.bom.gov.au/catalogue/anon-ftp.shtml">http://www.bom.gov.au/catalogue/anon-ftp.shtml</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dataset</td><td>Timeseries dataset to populate with data. </td></tr>
    <tr><td class="paramname">filename</td><td>Station filename obtained from BOM_Stations_TypeDef. </td></tr>
    <tr><td class="paramname">year_month</td><td>Year and month of interest e.g. 202206 for 2022 06 (June) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns cURL status code. </dd></dl>

</div>
</div>
<a id="a66ed16101a6e5215921e1c235df386ca" name="a66ed16101a6e5215921e1c235df386ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66ed16101a6e5215921e1c235df386ca">&#9670;&nbsp;</a></span>BOM_HistoricalWeatherToDB()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BOM_HistoricalWeatherToDB </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_b_o_m___weather_station___type_def.html">BOM_WeatherStation_TypeDef</a> *&#160;</td>
          <td class="paramname"><em>weather_station</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_b_o_m___weather_dataset___type_def.html">BOM_WeatherDataset_TypeDef</a> *&#160;</td>
          <td class="paramname"><em>dataset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PGconn *&#160;</td>
          <td class="paramname"><em>psql_conn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write observed weather to PostgreSQL table (weather_bom) </p>
<p >Turn a weather station dataset from the BOM into database values.</p>
<p >Rows that already exist are overwritten, new rows are added. Need to ensure each dataset and weather station are from the same source. These data are inserted into the weather_bom PostgreSQL table.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">weather_station</td><td>BOM weather station information. </td></tr>
    <tr><td class="paramname">dataset</td><td>BOM weather station dataset. </td></tr>
    <tr><td class="paramname">psql_conn</td><td>PostgreSQL connection handler. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab596a78a9e22aee099c2b1d399e7587b" name="ab596a78a9e22aee099c2b1d399e7587b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab596a78a9e22aee099c2b1d399e7587b">&#9670;&nbsp;</a></span>BOM_LoadWeatherFromCSV()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int8_t BOM_LoadWeatherFromCSV </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_b_o_m___weather_dataset___type_def.html">BOM_WeatherDataset_TypeDef</a> *&#160;</td>
          <td class="paramname"><em>dataset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_b_o_m___weather_station___type_def.html">BOM_WeatherStation_TypeDef</a> *&#160;</td>
          <td class="paramname"><em>station</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load BOM weather station dataset from .csv file. </p>
<p >Load a BOM dataset from a cached .csv file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>File to load (includes path). </td></tr>
    <tr><td class="paramname">dataset</td><td>Dataset to populate. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Status code. </dd></dl>

</div>
</div>
<a id="aae0ff9343e29da7ec59110cb0801c75b" name="aae0ff9343e29da7ec59110cb0801c75b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae0ff9343e29da7ec59110cb0801c75b">&#9670;&nbsp;</a></span>BOM_ParseWeather()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int8_t BOM_ParseWeather </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_utils___req_data___type_def.html">Utils_ReqData_TypeDef</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_b_o_m___weather_dataset___type_def.html">BOM_WeatherDataset_TypeDef</a> *&#160;</td>
          <td class="paramname"><em>dataset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_b_o_m___weather_station___type_def.html">BOM_WeatherStation_TypeDef</a> *&#160;</td>
          <td class="paramname"><em>station</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Saves a downloaded .csv dataset to a file. Also parses the data into a BOM dataset struct.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">stream</td><td>Contains raw string with .csv file. </td></tr>
    <tr><td class="paramname">dataset</td><td>Dataset to populate. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Status code OK = 0 ... ERROR = -1 </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_5c1a389c19f5e1aef93d90d0120de696.html">BOM</a></li><li class="navelem"><a class="el" href="historical__weather_8c.html">historical_weather.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
</body>
</html>
