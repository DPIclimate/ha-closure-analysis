<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Oyster Harvest Area Closure Analysis: src/transform.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Oyster Harvest Area Closure Analysis<span id="projectnumber">&#160;0.1</span>
   </div>
   <div id="projectbrief">Prediction and analysis of NSW oyster harvest area closures.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('transform_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">transform.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="transform_8h_source.html">transform.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for transform.c:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="transform_8c__incl.svg" width="1687" height="564"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8bfd3e88d3fb0be43988313009d4769a"><td class="memItemLeft" align="right" valign="top">static float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transform_8c.html#a8bfd3e88d3fb0be43988313009d4769a">T_Normalise</a> (const float value, const float min, const float max)</td></tr>
<tr class="memdesc:a8bfd3e88d3fb0be43988313009d4769a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function for nomalising data.  <a href="transform_8c.html#a8bfd3e88d3fb0be43988313009d4769a">More...</a><br /></td></tr>
<tr class="separator:a8bfd3e88d3fb0be43988313009d4769a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4189d4916467017dc3d00c2551a74a56"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transform_8c.html#a4189d4916467017dc3d00c2551a74a56">T_BuildWeatherDB</a> (<a class="el" href="struct_t___locations_lookup___type_def.html">T_LocationsLookup_TypeDef</a> *locations, PGconn *psql_conn)</td></tr>
<tr class="memdesc:a4189d4916467017dc3d00c2551a74a56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build weather table in PostgreSQL database.  <a href="transform_8c.html#a4189d4916467017dc3d00c2551a74a56">More...</a><br /></td></tr>
<tr class="separator:a4189d4916467017dc3d00c2551a74a56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae06774642cc02397bc8d37a57ca075fa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transform_8c.html#ae06774642cc02397bc8d37a57ca075fa">T_FloodPrediction</a> (PGconn *psql_conn)</td></tr>
<tr class="memdesc:ae06774642cc02397bc8d37a57ca075fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transforms data from all harvest programs into flood prediction.  <a href="transform_8c.html#ae06774642cc02397bc8d37a57ca075fa">More...</a><br /></td></tr>
<tr class="separator:ae06774642cc02397bc8d37a57ca075fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af84e961bc2a197a4318707ec0e98ebe4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transform_8c.html#af84e961bc2a197a4318707ec0e98ebe4">T_WindowDataset</a> (PGconn *psql_conn, const int program_id)</td></tr>
<tr class="memdesc:af84e961bc2a197a4318707ec0e98ebe4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Window dataset into sum of next 8-days and previous 5-days.  <a href="transform_8c.html#af84e961bc2a197a4318707ec0e98ebe4">More...</a><br /></td></tr>
<tr class="separator:af84e961bc2a197a4318707ec0e98ebe4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc30e5d03c575a8015b78be377706aad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transform_8c.html#adc30e5d03c575a8015b78be377706aad">T_NormaliseWindowedPrecipitation</a> (PGconn *psql_conn, const int program_id)</td></tr>
<tr class="memdesc:adc30e5d03c575a8015b78be377706aad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Normalise summed moving window precipitation between 0 and 1.  <a href="transform_8c.html#adc30e5d03c575a8015b78be377706aad">More...</a><br /></td></tr>
<tr class="separator:adc30e5d03c575a8015b78be377706aad"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a4189d4916467017dc3d00c2551a74a56" name="a4189d4916467017dc3d00c2551a74a56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4189d4916467017dc3d00c2551a74a56">&#9670;&#160;</a></span>T_BuildWeatherDB()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void T_BuildWeatherDB </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t___locations_lookup___type_def.html">T_LocationsLookup_TypeDef</a> *&#160;</td>
          <td class="paramname"><em>locations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PGconn *&#160;</td>
          <td class="paramname"><em>psql_conn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Build weather table in PostgreSQL database. </p>
<p >Main weather table for each location.</p>
<p >This table contains both forecasted and historical weather information for each harvest location. One column contains precipitation data where forecasted weather is added first, then overwritten using observed values. Both forecasted and observed data are stored in seperate columns.</p>
<dl class="section note"><dt>Note</dt><dd>This function requires weather_ibm_eis and weather_bom tables to be populated.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">locations</td><td>Unique locations information. </td></tr>
    <tr><td class="paramname">psql_conn</td><td>PostgreSQL connection handler. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae06774642cc02397bc8d37a57ca075fa" name="ae06774642cc02397bc8d37a57ca075fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae06774642cc02397bc8d37a57ca075fa">&#9670;&#160;</a></span>T_FloodPrediction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void T_FloodPrediction </td>
          <td>(</td>
          <td class="paramtype">PGconn *&#160;</td>
          <td class="paramname"><em>psql_conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transforms data from all harvest programs into flood prediction. </p>
<p >@breif Main entry point for calculating the risk of a harvest area closure.</p>
<p >Gets a list of the harvest areas. Loops through each of these locations to calcualte a windowed moving average of precipitation and then normalises this window to provide a value between 0 and 1.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">psql_conn</td><td>PostgreSQL connection. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8bfd3e88d3fb0be43988313009d4769a" name="a8bfd3e88d3fb0be43988313009d4769a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bfd3e88d3fb0be43988313009d4769a">&#9670;&#160;</a></span>T_Normalise()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static float T_Normalise </td>
          <td>(</td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>max</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper function for nomalising data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">value</td><td>Raw input value. </td></tr>
    <tr><td class="paramname">min</td><td>Raw maxiumum value. </td></tr>
    <tr><td class="paramname">max</td><td>Raw miniumum value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Normalised input value (between 0 and 1). </dd></dl>

</div>
</div>
<a id="adc30e5d03c575a8015b78be377706aad" name="adc30e5d03c575a8015b78be377706aad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc30e5d03c575a8015b78be377706aad">&#9670;&#160;</a></span>T_NormaliseWindowedPrecipitation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void T_NormaliseWindowedPrecipitation </td>
          <td>(</td>
          <td class="paramtype">PGconn *&#160;</td>
          <td class="paramname"><em>psql_conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>program_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Normalise summed moving window precipitation between 0 and 1. </p>
<p >@breif Normalise precipiation data between 0 and 1.</p>
<p >After a summed window average has been completed by <code>T_WindowDataset</code> the data can then be normalised. This normalisation is program specific i.e. each normalisations max and min are based on that program only and not the max and min of all programs in NSW.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">psql_conn</td><td>PostgreSQL connection. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af84e961bc2a197a4318707ec0e98ebe4" name="af84e961bc2a197a4318707ec0e98ebe4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af84e961bc2a197a4318707ec0e98ebe4">&#9670;&#160;</a></span>T_WindowDataset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void T_WindowDataset </td>
          <td>(</td>
          <td class="paramtype">PGconn *&#160;</td>
          <td class="paramname"><em>psql_conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>program_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Window dataset into sum of next 8-days and previous 5-days. </p>
<p >Window transform Z-Score values into a probability of flooding event.</p>
<p >For each <code>program_id</code> calcualte the sum of the next 8-days precipitation and the previous 5-days preciptiation. This acts as a moving window across all available data.</p>
<dl class="section note"><dt>Note</dt><dd>The outlook and hindlook can be adjusted by altering the <code>w_start</code> and <code>w_end</code> variables in this function.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">psql_conn</td><td>PostgreSQL connection. </td></tr>
    <tr><td class="paramname">program_id</td><td>Food authority program ID. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="transform_8c.html">transform.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
